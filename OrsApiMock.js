import { HttpMock } from "../lib-http/HttpMock.js";
import { Url } from "../lib-http/Url.js";
export { OrsApiMock };


let ch813 = `<div class="WordSection1">

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><b><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>      813.010
Driving under the influence of intoxicants; penalty.</span></b><span
style='font-size:12.0pt;font-family:"Times New Roman",serif'> (1) A person
commits the offense of driving while under the influence of intoxicants if the
person drives a vehicle while the person:</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>      (a)
Has 0.08 percent or more by weight of alcohol in the blood of the person as
shown by chemical analysis of the breath or blood of the person made under ORS
813.100, 813.140 or 813.150;</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>      (b)
Is under the influence of intoxicating liquor, cannabis, psilocybin, a
controlled substance or an inhalant;</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>      (c)
Is under the influence of any combination of intoxicating liquor, cannabis,
psilocybin, a controlled substance and an inhalant; or</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>      (d)
Within two hours after driving a vehicle, and without consuming alcohol in the
intervening time period, has 0.08 percent or more by weight of alcohol in the
blood of the person, as shown by chemical analysis of the breath or blood of
the person made under ORS 813.100, 813.140 or 813.150.</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>      (2)
A person may not be convicted of driving while under the influence of
intoxicants on the basis of being under the influence of a controlled substance
or an inhalant unless the fact that the person was under the influence of a
controlled substance or an inhalant is pleaded in the accusatory instrument and
is either proved at trial or is admitted by the person through a guilty plea.</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>      (3)
A person convicted of the offense described in this section is subject to ORS
813.020 in addition to this section.</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>      (4)
Except as provided in subsection (5) of this section, the offense described in
this section, driving while under the influence of intoxicants, is a Class A
misdemeanor and is applicable upon any premises open to the public.</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>      (5)(a)
Driving while under the influence of intoxicants is a Class C felony if the
current offense was committed in a motor vehicle and the person has, at least
three times in the 10 years prior to the date of the current offense, been
convicted of, or been found to be within the jurisdiction of the juvenile court
for an act that if committed by an adult would be, any of the following
offenses in any combination:</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>      (A)
Driving while under the influence of intoxicants in violation of this section.</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>      (B)
The statutory counterpart to this section in another jurisdiction.</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>      (C)
A driving under the influence of intoxicants offense in another jurisdiction
that involved the impaired driving or operation of a vehicle, an aircraft or a
boat due to the use of intoxicating liquor, cannabis, psilocybin, a controlled
substance, an inhalant or any combination thereof.</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>      (D)
A driving offense in another jurisdiction that involved operating a vehicle, an
aircraft or a boat while having a blood alcohol content above that jurisdiction’s
permissible blood alcohol content.</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>      (b)
For the purposes of paragraph (a) of this subsection, a conviction or
adjudication for a driving offense in another jurisdiction based solely on a
person under 21 years of age having a blood alcohol content that is lower than
the permissible blood alcohol content in that jurisdiction for a person 21
years of age or older does not constitute a prior conviction or adjudication.</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>      (6)
In addition to any other sentence that may be imposed, the court shall impose
one or more of the following fines on a person convicted of driving while under
the influence of intoxicants as follows:</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>      (a)
For a person’s first conviction, a minimum of $1,000.</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>      (b)
For a person’s second conviction, a minimum of $1,500.</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>      (c)
For a person’s third or subsequent conviction, a minimum of $2,000 if the
person is not sentenced to a term of imprisonment.</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>      (d)(A)
For a person who drives a vehicle while the person has 0.15 percent or more by
weight of alcohol in the blood of the person as shown by chemical analysis of
the breath or blood of the person made under ORS 813.100, 813.140 or 813.150, a
minimum of $2,000.</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>      (B)
For a person who, within two hours after driving a vehicle, and without
consuming alcohol in the intervening time period, has 0.15 percent or more by
weight of alcohol in the blood of the person, as shown by chemical analysis of
the breath or blood of the person made under ORS 813.100, 813.140 or 813.150, a
minimum of $2,000.</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>      (7)
Notwithstanding ORS 161.635, $10,000 is the maximum fine that a court may
impose on a person convicted of driving while under the influence of
intoxicants if:</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>      (a)
The current offense was committed in a motor vehicle; and</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>      (b)
There was a passenger in the motor vehicle who was under 18 years of age and
was at least three years younger than the person driving the motor vehicle. [1983
c.338 §587; 1985 c.16 §293; 1987 c.138 §5; 1991 c.835 §7; 1999 c.619 §3; 1999
c.1049 §1; 2003 c.14 §495; 2003 c.445 §1; 2007 c.879 §3; 2009 c.525 §1; 2009
c.613 §1; 2017 c.21 §80; 2021 c.253 §6; 2021 c.480 §1]</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>&nbsp;</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><b><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>      813.011
Felony driving under the influence of intoxicants; penalty.</span></b><span
style='font-size:12.0pt;font-family:"Times New Roman",serif'> (1) Driving under
the influence of intoxicants under ORS 813.010 shall be a Class C felony if at
least two times in the 10 years prior to the date of the current offense the
defendant has been convicted of any of the following offenses in any
combination:</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>      (a)
Driving under the influence of intoxicants in violation of ORS 813.010, or its
statutory counterpart in another jurisdiction.</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>      (b)
A driving under the influence of intoxicants offense in another jurisdiction
that involved the impaired driving or operation of a vehicle, an aircraft or a
boat due to the use of intoxicating liquor, cannabis, a controlled substance,
an inhalant or any combination thereof.</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>      (c)
An offense in another jurisdiction that involved driving or operating a
vehicle, an aircraft or a boat while having a blood alcohol content above that
jurisdiction’s permissible blood alcohol content.</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>      (2)
Once a person has been sentenced for a Class C felony under this section, the
10-year time limitation is eliminated and any subsequent episode of driving
under the influence of intoxicants shall be a Class C felony regardless of the
amount of time which intervenes.</span></p>

<p class=MsoNormal style='margin-bottom:0in;line-height:normal;text-autospace:
none'><span style='font-size:12.0pt;font-family:"Times New Roman",serif'>      (3)
Upon conviction for a Class C felony under this section, the person shall be
sentenced to a mandatory minimum term of incarceration of 90 days, without
reduction for any reason. [2011 c.1 §3; 2011 c.598 §2; 2021 c.480 §2]</span></p>

</div>`;


const chapters = {};

chapters["813"] = [ch813];


class OrsApiMock extends HttpMock {
    //https://appdev.ocdla.org/books-online/index.php?chapter=813&section=010
    errors = {
        'success': false,
        'error': 'Invalid inputs'
    };


    getResponse(req) {
        let url = new Url(req.url);
        let data = [];

        let query = url.getQuery();


        try {
            if (!chapters[query.chapter]) {
                throw new RangeError("Chapter does not exist.", { cause: "INVALID_CHAPTER" });
            }
            return new Response(chapters[query.chapter]);

        } catch (e) {
            data = e.message;
        }



        return new Response(data);
    }

    /* filterSections(chapter, section = null) {
        let results = [];
        let ch = chapters[chapter];
        if (!section) {
            return ch;
        }
        for (let i = 0; i < ch.length; i++) {
            let sect = ch[i];
            let parts = sect.slice(0, 7);
            parts = parts.split(".");
            if (parts[1] == section) {
                results.push(sect);
            }
        }
        console.log(results.length);
        if (results.length == 0) {
            throw new RangeError("Section does not exist.", { cause: "INVALID_SECTION" });
        }
        return results;
    } */


}
